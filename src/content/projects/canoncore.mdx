---
title: 'CanonCore'
category: 'Personal Project'
description: 'Google Drive meets Netflix. Visual browsing, drag-and-drop organisation, watch progress, collections others can fork.'
technologies:
  [
    'Next.js 16',
    'React 19',
    'TypeScript',
    'PostgreSQL',
    'Prisma 7',
    'Tailwind CSS 4',
    'NextAuth.js v5',
    'Vitest',
    'Playwright',
    'Storybook',
  ]
link: 'https://canoncore.com'
github: 'https://github.com/jacobreesgit/canoncore-v2'
image: '/images/canoncore.webp'
year: '2025–Present'
featured: true
---

## The Product

CanonCore turns Google Drive into a fully featured media library: visual browsing, metadata enrichment, progress tracking, and public sharing, without moving or duplicating your files. The name comes from "canon" - the app pulls canonical metadata from sources like [TMDB](https://www.themoviedb.org), with planned support for Fandom/MediaWiki and more. Create folder structures for movies and TV shows, reorganise with drag and drop, enrich items from [TMDB](https://www.themoviedb.org), track what you've watched, and share collections publicly. Your files live in your storage, not ours.

I use this daily for my own movie and TV library. Active development continues with planned features including native iOS and tvOS apps.

---

## Features

<div className="not-prose mt-6 grid gap-24 lg:gap-32">

{/* Browsing & Organisation */}

<div className="grid items-center gap-8 lg:grid-cols-2 lg:gap-12">
  <div className="order-2 lg:order-1">
    <h3 className="text-foreground mb-4 text-xl font-semibold tracking-tight">
      Browsing & Organisation
    </h3>
    <div className="space-y-4">
      <div className="text-muted-foreground leading-relaxed">
        Two views: Grid is Netflix-style with poster cards and progress bars.
        Tree is file explorer-style showing all descendants at once. Every item
        page has a hero banner. Folders display watched and total counts using a
        90% completion threshold to account for credit skipping. "Go to next"
        performs a depth-first traversal to locate your first incomplete item
        automatically.
      </div>
      <div className="text-muted-foreground leading-relaxed">
        Edit mode enables drag-and-drop, bulk selection, and full keyboard
        navigation with screen reader announcements. Pinned items (max 10)
        appear in the sidebar. [dnd-kit](https://dndkit.com) only loads in edit
        mode to keep browsing fast.
      </div>
    </div>
  </div>
  <div className="order-1 lg:order-2">
    <CarouselStandard2
      images={[
        '/portfolio/canoncore-01-library-grid-dark-desktop-thumb.webp',
        '/portfolio/canoncore-02-tree-view-dark-desktop-thumb.webp',
      ]}
      alt={['Grid view', 'Tree view']}
      buttonLabels={['Grid', 'Tree']}
    />
  </div>
</div>

{/* Media Playback */}

<div className="grid items-center gap-8 lg:grid-cols-2 lg:gap-12">
  <div className="order-1">
    <CarouselStandard2
      images={[
        '/portfolio/canoncore-03-video-dark-desktop-thumb.webp',
        '/portfolio/canoncore-03-video-dark-mobile-thumb.webp',
      ]}
      alt={[
        'Desktop video player with subtitle tracks',
        'Mobile video player with subtitle tracks',
      ]}
      buttonLabels={['Desktop', 'Mobile']}
    />
  </div>
  <div className="order-2">
    <h3 className="text-foreground mb-4 text-xl font-semibold tracking-tight">
      Media Playback
    </h3>
    <div className="space-y-4">
      <div className="text-muted-foreground leading-relaxed">
        [Vidstack](https://vidstack.io)-powered player streams media directly
        from Google Drive via HTTP range requests. Playback position auto-saves
        and resumes where you left off. Supports SRT, VTT, SUB, and ASS subtitle
        tracks.
      </div>
    </div>
  </div>
</div>

{/* One-Click Metadata */}

<div className="grid items-center gap-8 lg:grid-cols-2 lg:gap-12">
  <div className="order-2 lg:order-1">
    <h3 className="text-foreground mb-4 text-xl font-semibold tracking-tight">
      One-Click Metadata
    </h3>
    <div className="text-muted-foreground leading-relaxed">
      You can enrich movies and TV shows with [TMDB](https://www.themoviedb.org)
      metadata. A three-step wizard lets you search for a title, select from
      multiple poster options, and choose a backdrop image for hero banners.
    </div>
  </div>
  <div className="order-1 lg:order-2">
    <CarouselStandard2
      images={[
        '/portfolio/canoncore-04-tmdb-wizard-dark-desktop-thumb.webp',
        '/portfolio/canoncore-04-tmdb-wizard-dark-mobile-thumb.webp',
      ]}
      alt={[
        'Desktop TMDB search wizard with poster selection',
        'Mobile TMDB search wizard with poster selection',
      ]}
      buttonLabels={['Desktop', 'Mobile']}
    />
  </div>
</div>

{/* Google Drive Sync */}

<div className="grid items-center gap-8 lg:grid-cols-2 lg:gap-12">
  <div className="order-1">
    <CarouselStandard2
      images={[
        '/portfolio/canoncore-06-google-drive-sync-dark-desktop-thumb.webp',
        '/portfolio/canoncore-06-google-drive-sync-dark-mobile-thumb.webp',
      ]}
      alt={[
        'Desktop sync panel and Drive connection UI',
        'Mobile sync panel and Drive connection UI',
      ]}
      buttonLabels={['Desktop', 'Mobile']}
    />
  </div>
  <div className="order-2">
    <h3 className="text-foreground mb-4 text-xl font-semibold tracking-tight">
      Google Drive Sync
    </h3>
    <div className="text-muted-foreground leading-relaxed">
      All your media files stay in your Drive. Google's Changes API enables
      incremental syncs, fetching only changed items since the last update. If
      incremental sync returns no results, a verification step triggers a full
      sync. Conflicts are handled gracefully: if a file changed in Drive since
      your last sync, local changes are rejected with a notification. Errors are
      isolated per file.
    </div>
  </div>
</div>

{/* Public Sharing */}

<div className="grid items-center gap-8 lg:grid-cols-2 lg:gap-12">
  <div className="order-2 lg:order-1">
    <h3 className="text-foreground mb-4 text-xl font-semibold tracking-tight">
      Public Sharing
    </h3>
    <div className="text-muted-foreground leading-relaxed">
      Make items public to share them. Your profile page shows your public
      items. The explore page shows public items from everyone with a featured
      banner carousel.
    </div>
  </div>
  <div className="order-1 lg:order-2">
    <CarouselStandard2
      images={[
        '/portfolio/canoncore-07-explore-page-dark-desktop-thumb.webp',
        '/portfolio/canoncore-07-explore-page-dark-mobile-thumb.webp',
      ]}
      alt={[
        'Desktop explore page with featured carousel',
        'Mobile explore page with featured carousel',
      ]}
      buttonLabels={['Desktop', 'Mobile']}
    />
  </div>
</div>

{/* Forking */}

<div className="grid items-center gap-8 lg:grid-cols-2 lg:gap-12">
  <div className="order-1">
    <CarouselStandard2
      images={[
        '/portfolio/canoncore-32-fork-dialog-dark-desktop-thumb.webp',
        '/portfolio/canoncore-32-fork-dialog-dark-mobile-thumb.webp',
      ]}
      alt={['Desktop fork to library dialog', 'Mobile fork to library dialog']}
      buttonLabels={['Desktop', 'Mobile']}
    />
  </div>
  <div className="order-2">
    <h3 className="text-foreground mb-4 text-xl font-semibold tracking-tight">
      Forking
    </h3>
    <div className="text-muted-foreground leading-relaxed">
      Visibility inherits through the hierarchy—items can be public, private, or
      inherit from a parent. A public item with a private ancestor stays
      inaccessible. Other users can fork your collections into their own
      library, copying names, descriptions, artwork, and hierarchy. Media files
      and subtitles stay private. Think of it like sharing a Spotify playlist:
      the structure is public, the files aren't.
    </div>
  </div>
</div>

{/* Spotlight Search */}

<div className="grid items-center gap-8 lg:grid-cols-2 lg:gap-12">
  <div className="order-2 lg:order-1">
    <h3 className="text-foreground mb-4 text-xl font-semibold tracking-tight">
      Spotlight Search
    </h3>
    <div className="text-muted-foreground leading-relaxed">
      Press <code className="rounded bg-white/10 px-1.5 py-0.5 text-sm">/</code>{' '}
      anywhere to open Spotlight Search. Results load in parallel across Your
      Items, Public Collections, and People. A 60-second cache gives instant
      responses on repeat searches. Breadcrumb paths reveal each item's full
      hierarchy.
    </div>
  </div>
  <div className="order-1 lg:order-2">
    <CarouselStandard2
      images={[
        '/portfolio/canoncore-08-spotlight-search-dark-desktop-thumb.webp',
        '/portfolio/canoncore-08-spotlight-search-dark-mobile-thumb.webp',
      ]}
      alt={['Desktop spotlight search modal', 'Mobile spotlight search modal']}
      buttonLabels={['Desktop', 'Mobile']}
    />
  </div>
</div>

{/* Built-in Documentation */}

<div className="grid items-center gap-8 lg:grid-cols-2 lg:gap-12">
  <div className="order-1">
    <CarouselStandard2
      images={[
        '/portfolio/canoncore-36-docs-dark-desktop-thumb.webp',
        '/portfolio/canoncore-36-docs-dark-mobile-thumb.webp',
      ]}
      alt={[
        'Desktop documentation with navigation and search',
        'Mobile documentation with navigation and search',
      ]}
      buttonLabels={['Desktop', 'Mobile']}
    />
  </div>
  <div className="order-2">
    <h3 className="text-foreground mb-4 text-xl font-semibold tracking-tight">
      Built-in Documentation
    </h3>
    <div className="text-muted-foreground leading-relaxed">
      Includes a documentation site built with
      [Fumadocs](https://fumadocs.vercel.app).
    </div>
  </div>
</div>

</div>

---

## How It's Built

### Architecture Decisions

**Google Drive migration:** I originally built this on SFTP, but path-based matching meant every rename or move created duplicates. No stable IDs, no change detection API, read-only from the web. Google Drive solved all of it: permanent file IDs survive renames and moves, Changes API for incremental sync, full read/write access so users can create folders directly from CanonCore. Should have started here.

**Stack Auth → NextAuth.js v5:** I started with managed auth, then migrated to self-hosted JWT sessions after hitting rate limits. I added **15+ rate limiters** via [Upstash Redis](https://upstash.com) with different thresholds per action (strict for auth, generous for browsing).

---

### Security & Resilience

Circuit breaker on [TMDB](https://www.themoviedb.org) and Google Drive calls to handle failures gracefully. Edge-level bot protection blocks **35+ AI crawlers** while rate-limiting beneficial bots.

---

### Performance

Extracted a view-only Grid from SortableGrid to avoid [dnd-kit](https://dndkit.com) overhead in browse mode. Actions queue to IndexedDB when offline and replay on reconnect. Google Drive operations batched up to **100 per request**, reducing sync time from **~45s to ~3s**.

---

### Accessibility

WCAG 2.1 AA compliant throughout. Reduced motion support via a custom hook that disables carousel autoplay and animations. Skip link to main content. ARIA live regions for drag-and-drop announcements.

---

### Testing

**2,400+ tests** across unit, integration, and E2E layers. [Vitest](https://vitest.dev) unit tests cover auth, items, Google Drive sync, and crypto operations. Integration tests run against real PostgreSQL. E2E tests with [Playwright](https://playwright.dev) use the Page Object Model pattern and test against a real Google Drive account, not mocked. Tests automatically create missing fixtures for self-healing reliability.

---

### Component Documentation

All custom components are documented in [Storybook](https://canoncore-storybook.vercel.app).

---

## Tech Stack

**Front End:** Next.js 16, React 19, TypeScript, Tailwind CSS 4, shadcn/ui, Vidstack, [dnd-kit](https://dndkit.com), cmdk

**Back End:** Prisma 7, NextAuth.js v5, Server Actions

**APIs:** Google Drive (OAuth 2.0, Changes API), TMDB

**Infrastructure:** Vercel, Neon PostgreSQL (serverless branching), Upstash Redis, Pino
